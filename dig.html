<style>

body{ font-family: Courier;
}

</style>
<br><br>
<br><br>
<br><br>
<div id="stage">

</div>

<script>

/*********************************************************
To-Do URGENT:

-Add Worker array to iterate through actions/draws - Logan

-function to add and remove workers from the worker array

-add ability for workers to dig (and move vertically along the ground) - James

-Add a check for the stage to update necessary visual changes(slopes for dug ground?)

-Add an inventory area to track collected items - Justin

-Add support for dynamic level size
************************************************************
Future Ideas and Goals:

-add enemies
-when finishing a temple you earn favor for upgrades?
-add a shop/upgrades
-add larger temple construction sites
-locally store your progress
-add coinhive
-host on a site

**********************************************************
Suggestions:
Add random gems or fossils durring digging phase



**********************************************************/


/*********************************************************
Adds spans with coordinate based ID's
**********************************************************/

function addSpans(x, y){

	for(i=0;i<x;i++){
	document.getElementById("stage").innerHTML+="|"
		for(k=0;k<y;k++){
			document.getElementById("stage").innerHTML+="<span id='"+k+" "+i+"'>&nbsp;</span>";
		}
	document.getElementById("stage").innerHTML+="|<br>"

	}

}
/*********************************************************
Constructor for objects held in the stage array
for now they just hold the text that displays in the level
for this object
**********************************************************/
function Spot(text){
	this.text = text;
	
}


/*********************************************************
Constructor for objects held in the stage array
for now they just hold the text that displays in the level
for this object
**********************************************************/
function CurrentStage(){

this.type
this.grid = createArray(20, 6);
this.clears
this.digs
this.tree = 0
this.rock = 0
}

/*********************************************************
Method for the game loop to redraw the stage to track
movement
**********************************************************/
CurrentStage.prototype.draw = function(){

	for(i=0;i<20;i++){
	
		for(k=0;k<6;k++){
			
			if( this.grid[i][k].text == " ")
			document.getElementById(i+" "+k).innerHTML="&nbsp;";
			else
			document.getElementById(i+" "+k).innerHTML=this.grid[i][k].text;
			
		}

	}
}
/*********************************************************
Method for building your own stage.  Stages are limited to
20x6 right now.
**********************************************************/
CurrentStage.prototype.setupThreeStep = function(){
	//building the initial stage blocks for a 3-step pyramid level
	// T=Tree ,=rock  _=dirt_ground
	var level = "                    "+
				"                    "+
				"                    "+
				"__T__T_T_,___TTTTTT_"+
				"____________________"+
				"____________________";
	//clears required
	this.clears = 4;
	//digs required
	this.digs = 4;
	//builds required
	this.builds = 13;
	
	//Entering the level into the array
	var count = 0;
	for(i=0;i<6;i++){
	
		for(k=0;k<20;k++){
			var piece = level.substr(count,1);
			
			this.grid[k][i] = new Spot(piece);
			count++;
		}
	}
	
}
/*********************************************************
borrowed code from stackoverflow for creating n-dimension array
**********************************************************/
function createArray(length) {
    var arr = new Array(length || 0),
        i = length;

    if (arguments.length > 1) {
        var args = Array.prototype.slice.call(arguments, 1);
        while(i--) arr[length-1 - i] = createArray.apply(this, args);
    }

    return arr;
}
/*********************************************************
little worker, works so hard digging, hauling, and building
**********************************************************/
function Worker(){
	this.x = 19;
	this.y = 3;
	//preplanned target
	this.workTarget="";
		
	// Current Job
	this.job="clearing";
	
	//randomizing worker symbol
	var sym = Math.floor(Math.random() * (10 - 0));
	//alert(sym);
	switch(sym) {
    case 0:
        this.text = "☼";
        break;
    case 1:
        this.text = "☺";
        break;
	case 2:
        this.text = "z";
        break;
	case 3:
        this.text = "♥";
        break;
	case 4:
        this.text = "♂";
        break;
	case 5:
        this.text = "♀";
        break;
	case 6:
        this.text = "♠";
        break;
	case 7:
        this.text = "☻";
        break;
	case 8:
        this.text = "♣";
        break;
	case 9:
        this.text = "♦";
        break;
    default:
        this.text = "§";
	}
	
	this.item = "&nbsp;";
	this.clears=0;
	this.digs=0;
	this.builds=0;
}

/*********************************************************
The worker checks to see if he is clearing, digging, or building
**********************************************************/
Worker.prototype.jobCheck=function()
{

}

/*********************************************************
The worker checks if he's carrying something
**********************************************************/
Worker.prototype.handCheck=function()
{

}

/*********************************************************
The worker digs
**********************************************************/
Worker.prototype.dig=function()
{

}

/*********************************************************
The worker picks up debris
**********************************************************/
Worker.prototype.pickupDebris=function()
{

}

/*********************************************************
The worker goes to obtain brick
**********************************************************/
Worker.prototype.obtainBrick=function()
{

}




/*********************************************************
the worker analyzes his situation and act accordingly
to clear the area, dig the pit, and build the temple.
**********************************************************/
Worker.prototype.action= function(){
	//bob's hand are empty
	if (this.item=="&nbsp;"){
		//clearing stage
		if (this.clears < curStage.clears){
				//checking for debris
				if( curStage.grid[this.x-1][this.y].text == "_"){
					//moving left
					this.x-=1;
				}
				else{
					//picking up the debris when found and adding it to bobs items
					this.item = curStage.grid[this.x-1][this.y].text;
					//removing the item from the stage array
					curStage.grid[this.x-1][this.y].text ="_";
					
				}
		}	
	}
	//bob now has an item and must move it off the right side of the screen
	else{
		if(this.x !=19){
		//move right
			this.x+=1;
		}
		else{
			//Checks if it's a tree
			if (this.item == "T"){
				curStage.tree = curStage.tree + 1;
			}
			else if (this.item == ","){
				curStage.rock = curStage.rock + 1;
			}
			this.item = "&nbsp;";
			document.getElementById("tree").innerHTML = curStage.tree;
			document.getElementById("rock").innerHTML = curStage.rock;
		}
	}
}
/*********************************************************
draws the worker on the screen according to his coords
**********************************************************/
Worker.prototype.draw = function(){
	document.getElementById(this.x+" "+this.y).innerHTML=this.text;
	document.getElementById(this.x+" "+(this.y-1)).innerHTML=this.item;
}

/*
createArray();     // [] or new Array()

createArray(2);    // new Array(2)

createArray(3, 2); // [new Array(2),
                   //  new Array(2),
                   //  new Array(2)]
*/

/****************************************************************
Add worker function
*****************************************************************/
function addWorker()
{
	workers[numberOfWorkers] = new Worker();
	numberOfWorkers+=1;
}
/****************************************************************
Remove worker function
*****************************************************************/
function removeWorker()
{
	if(numberOfWorkers>0)
	{
		numberOfWorkers-=1;
		workers.splice(numberOfWorkers, 1);
	}
}

/****************************************************************
Cycle through workers
*****************************************************************/
function workCycleAction()
{
    for(var w=0;w<numberOfWorkers;w++)
	{
		workers[w].action();
	}
}
/****************************************************************

****************************************************************/
function DrawWorkers()
{
    for(var w=0;w<numberOfWorkers;w++)
	{
		workers[w].draw();
	}
}

/*********************************************************
runs the game in order, currently 1 tick per sec
**********************************************************/
function gameLoop(){
//alert("tick");
//redraw the stage every tick

workCycleAction();

curStage.draw();

DrawWorkers();

}

//actual code

//number of workers
numberOfWorkers = 2;

curStage = new CurrentStage();

///create worker array
workers = new Array(numberOfWorkers);
//make new workers
for(var w=0;w<numberOfWorkers;w++)
{
	workers[w] = new Worker();
}

//curStage.grid[0][0]=1;

//alert(curStage.grid[0][0]);
//setting up the page
addSpans(6,20);
curStage.setupThreeStep();

var gameclock = setInterval("gameLoop()", 500);

</script>

<button onclick="addWorker()">Add Worker</button>
<button onclick="removeWorker()">Remove Worker</button>

<p>Tree: <span id = "tree"></span></p>
<p>Rock: <span id = "rock"></span></p>
